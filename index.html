<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soccer Penalty Shootout</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        body {
            font-family: 'Arial Black', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            overflow: hidden;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            background: linear-gradient(to bottom, #87CEEB 0%, #4CAF50 60%);
        }

        .field {
            position: absolute;
            top: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, #4CAF50, #2E7D32);
            overflow: hidden;
        }

        .field::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(90deg, transparent, transparent 48px, rgba(255,255,255,0.1) 48px, rgba(255,255,255,0.1) 50px);
            top: 0;
            left: 0;
        }

        .goal-area {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 180px;
            border: 6px solid white;
            border-top: none;
            background: rgba(0,0,0,0.2);
            border-radius: 0 0 10px 10px;
        }

        .goalpost {
            position: absolute;
            background: white;
            border-radius: 2px;
        }

        .goalpost.left {
            left: -6px;
            top: 0;
            width: 12px;
            height: 186px;
        }

        .goalpost.right {
            right: -6px;
            top: 0;
            width: 12px;
            height: 186px;
        }

        .goalpost.bottom {
            bottom: -6px;
            left: 0;
            width: 100%;
            height: 12px;
        }

        .goal-net {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(0deg, transparent, transparent 20px, rgba(255,255,255,0.3) 20px, rgba(255,255,255,0.3) 21px),
                repeating-linear-gradient(90deg, transparent, transparent 20px, rgba(255,255,255,0.3) 20px, rgba(255,255,255,0.3) 21px);
        }

        .goalkeeper {
            position: absolute;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            width: 45px;
            height: 70px;
            background: linear-gradient(to bottom, #FFE4B5, #DEB887);
            border-radius: 22px 22px 15px 15px;
            transition: all 0.4s ease;
            z-index: 10;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .goalkeeper::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 22px;
            height: 22px;
            background: #FFE4B5;
            border-radius: 50%;
            border: 2px solid #DEB887;
        }

        .goalkeeper::after {
            content: '';
            position: absolute;
            top: 35px;
            left: 50%;
            transform: translateX(-50%);
            width: 35px;
            height: 25px;
            background: #FF6B35;
            border-radius: 8px;
        }

        .goalkeeper.diving-left {
            transform: translateX(-200%) rotate(-25deg) scale(1.1);
            animation: dive 0.4s ease-out;
        }

        .goalkeeper.diving-right {
            transform: translateX(100%) rotate(25deg) scale(1.1);
            animation: dive 0.4s ease-out;
        }

        @keyframes dive {
            0% { transform: translateX(-50%) scale(1); }
            50% { transform: scale(1.15); }
            100% { transform: scale(1.1); }
        }

        .ball {
            position: absolute;
            bottom: 150px;
            left: 50%;
            transform: translateX(-50%);
            width: 35px;
            height: 35px;
            background: radial-gradient(circle at 35% 35%, #ffffff, #000000);
            border-radius: 50%;
            transition: all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 15;
            cursor: grab;
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
        }

        .ball:active {
            cursor: grabbing;
        }

        .ball::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            border: 3px solid #333;
            border-radius: 50%;
        }

        .ball::after {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            width: 8px;
            height: 8px;
            background: rgba(255,255,255,0.8);
            border-radius: 50%;
        }

        .aim-line {
            position: absolute;
            bottom: 167px;
            left: 50%;
            transform-origin: bottom center;
            width: 4px;
            background: linear-gradient(to top, #FFD700, transparent);
            border-radius: 2px;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 5;
            pointer-events: none;
        }

        .power-meter {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 20px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            border: 2px solid white;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .power-fill {
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #FFD700, #FF5722);
            border-radius: 8px;
            width: 0%;
            transition: width 0.1s ease;
        }

        .hud {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }

        .score-panel {
            background: rgba(0,0,0,0.8);
            padding: 15px 20px;
            border-radius: 15px;
            text-align: center;
            min-width: 120px;
            border: 2px solid #FFD700;
        }

        .score {
            font-size: 24px;
            font-weight: bold;
            color: #FFD700;
        }

        .level {
            font-size: 16px;
            margin-top: 5px;
            color: #87CEEB;
        }

        .progress {
            font-size: 14px;
            color: #FFF;
            margin-top: 5px;
        }

        .instructions-panel {
            background: rgba(0,0,0,0.8);
            padding: 10px 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #4CAF50;
        }

        .start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .game-title {
            font-size: 28px;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            text-align: center;
        }

        .start-btn {
            padding: 20px 40px;
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #FF6B35, #F7931E);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 15px rgba(0,0,0,0.3);
        }

        .start-btn:active {
            transform: translateY(2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .instructions {
            margin-top: 30px;
            text-align: center;
            color: #87CEEB;
            line-height: 1.8;
            max-width: 350px;
        }

        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .final-score {
            font-size: 36px;
            color: #FFD700;
            margin-bottom: 20px;
        }

        .message {
            font-size: 20px;
            color: white;
            margin-bottom: 30px;
            text-align: center;
        }

        .restart-btn {
            padding: 15px 30px;
            font-size: 20px;
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feedback {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 28px;
            font-weight: bold;
            opacity: 0;
            transition: all 0.5s ease;
            z-index: 50;
            pointer-events: none;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }

        .feedback.goal {
            color: #4CAF50;
        }

        .feedback.miss {
            color: #FF5722;
        }

        .feedback.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.3);
        }

        @media (max-width: 480px) {
            .game-title { font-size: 22px; }
            .start-btn { padding: 15px 30px; font-size: 20px; }
            .goal-area { width: 280px; height: 160px; }
            .score { font-size: 20px; }
            .goalkeeper { width: 40px; height: 60px; }
            .ball { width: 30px; height: 30px; }
            .power-meter { width: 160px; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="field">
            <div class="goal-area">
                <div class="goalpost left"></div>
                <div class="goalpost right"></div>
                <div class="goalpost bottom"></div>
                <div class="goal-net"></div>
            </div>
            
            <div class="goalkeeper" id="goalkeeper"></div>
            <div class="ball" id="ball"></div>
            <div class="aim-line" id="aimLine"></div>
            
            <div class="power-meter" id="powerMeter">
                <div class="power-fill" id="powerFill"></div>
            </div>
        </div>

        <div class="hud">
            <div class="score-panel">
                <div class="score" id="score">0</div>
                <div class="level">Level <span id="level">1</span></div>
                <div class="progress"><span id="goals">0</span>/5 Goals</div>
            </div>
            <div class="instructions-panel">
                <div style="font-size: 12px; color: #87CEEB;">Hold & drag ball to aim</div>
                <div style="font-size: 12px; color: #FFD700;">Release to shoot!</div>
            </div>
        </div>

        <div class="feedback" id="feedback"></div>

        <div class="start-screen" id="startScreen">
            <div class="game-title">⚽ PENALTY SHOOTOUT ⚽</div>
            <button class="start-btn" id="startBtn">START GAME</button>
            <div class="instructions">
                <p>🎯 <strong>Hold and drag</strong> the ball to aim</p>
                <p>⚡ <strong>Release</strong> to shoot with power</p>
                <p>🥅 Beat the goalkeeper and score goals</p>
                <p>⭐ Complete 5 goals per level to advance</p>
                <p>🏆 How far can you go?</p>
            </div>
        </div>

        <div class="game-over" id="gameOver">
            <div class="final-score" id="finalScore">Game Over!</div>
            <div class="message" id="gameOverMessage">Great effort!</div>
            <button class="restart-btn" id="restartBtn">PLAY AGAIN</button>
        </div>
    </div>

    <script>
        class SoccerGame {
            constructor() {
                this.score = 0;
                this.level = 1;
                this.goalsInLevel = 0;
                this.goalsPerLevel = 5;
                this.gameActive = false;
                this.shooting = false;
                this.aiming = false;
                this.startPos = { x: 0, y: 0 };
                this.currentPos = { x: 0, y: 0 };
                
                this.elements = {
                    startScreen: document.getElementById('startScreen'),
                    gameOver: document.getElementById('gameOver'),
                    startBtn: document.getElementById('startBtn'),
                    restartBtn: document.getElementById('restartBtn'),
                    ball: document.getElementById('ball'),
                    goalkeeper: document.getElementById('goalkeeper'),
                    score: document.getElementById('score'),
                    level: document.getElementById('level'),
                    goals: document.getElementById('goals'),
                    feedback: document.getElementById('feedback'),
                    finalScore: document.getElementById('finalScore'),
                    gameOverMessage: document.getElementById('gameOverMessage'),
                    aimLine: document.getElementById('aimLine'),
                    powerMeter: document.getElementById('powerMeter'),
                    powerFill: document.getElementById('powerFill')
                };
                
                this.initializeGame();
            }
            
            initializeGame() {
                this.elements.startBtn.addEventListener('click', () => this.startGame());
                this.elements.restartBtn.addEventListener('click', () => this.restartGame());
                
                // Touch events for ball
                this.elements.ball.addEventListener('touchstart', (e) => this.startAiming(e), { passive: false });
                this.elements.ball.addEventListener('touchmove', (e) => this.updateAim(e), { passive: false });
                this.elements.ball.addEventListener('touchend', (e) => this.shoot(e), { passive: false });
                
                // Mouse events for desktop testing
                this.elements.ball.addEventListener('mousedown', (e) => this.startAiming(e));
                document.addEventListener('mousemove', (e) => this.updateAim(e));
                document.addEventListener('mouseup', (e) => this.shoot(e));
            }
            
            startGame() {
                this.elements.startScreen.style.display = 'none';
                this.gameActive = true;
                this.resetGame();
            }
            
            resetGame() {
                this.score = 0;
                this.level = 1;
                this.goalsInLevel = 0;
                this.updateUI();
                this.resetBall();
            }
            
            restartGame() {
                this.elements.gameOver.style.display = 'none';
                this.resetGame();
                this.gameActive = true;
            }
            
            startAiming(e) {
                if (!this.gameActive || this.shooting) return;
                
                e.preventDefault();
                this.aiming = true;
                
                const touch = e.touches ? e.touches[0] : e;
                this.startPos = { x: touch.clientX, y: touch.clientY };
                this.currentPos = { x: touch.clientX, y: touch.clientY };
                
                this.elements.aimLine.style.opacity = '1';
                this.elements.powerMeter.style.opacity = '1';
            }
            
            updateAim(e) {
                if (!this.aiming) return;
                
                e.preventDefault();
                const touch = e.touches ? e.touches[0] : e;
                this.currentPos = { x: touch.clientX, y: touch.clientY };
                
                const deltaX = this.currentPos.x - this.startPos.x;
                const deltaY = this.currentPos.y - this.startPos.y;
                const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                const angle = Math.atan2(-deltaY, deltaX) * 180 / Math.PI + 90;
                
                // Update aim line
                const maxDistance = 150;
                const lineHeight = Math.min(distance, maxDistance);
                this.elements.aimLine.style.height = lineHeight + 'px';
                this.elements.aimLine.style.transform = `translateX(-50%) rotate(${angle}deg)`;
                
                // Update power meter
                const power = Math.min(distance / maxDistance * 100, 100);
                this.elements.powerFill.style.width = power + '%';
            }
            
            shoot(e) {
                if (!this.aiming) return;
                
                e.preventDefault();
                this.aiming = false;
                this.shooting = true;
                
                // Hide aim helpers
                this.elements.aimLine.style.opacity = '0';
                this.elements.powerMeter.style.opacity = '0';
                
                const deltaX = this.currentPos.x - this.startPos.x;
                const deltaY = this.currentPos.y - this.startPos.y;
                const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                
                if (distance < 20) {
                    this.shooting = false;
                    return; // Too small movement, cancel shot
                }
                
                this.animateShot(deltaX, deltaY, distance);
            }
            
            animateShot(deltaX, deltaY, power) {
                const ball = this.elements.ball;
                const goalkeeper = this.elements.goalkeeper;
                
                // Calculate shot properties
                const maxPower = 150;
                const normalizedPower = Math.min(power / maxPower, 1);
                const shotAccuracy = this.calculateAccuracy(deltaX, deltaY, normalizedPower);
                
                // Animate goalkeeper
                const goalkeepMove = this.getGoalkeeperMove();
                goalkeeper.className = 'goalkeeper';
                if (goalkeepMove === 'left') {
                    goalkeeper.classList.add('diving-left');
                } else if (goalkeepMove === 'right') {
                    goalkeeper.classList.add('diving-right');
                }
                
                // Calculate ball destination
                const goalArea = document.querySelector('.goal-area');
                const goalRect = goalArea.getBoundingClientRect();
                const ballRect = ball.getBoundingClientRect();
                
                // Add some randomness based on power and aim
                const accuracy = 0.7 + (normalizedPower * 0.3);
                const targetX = (deltaX * 2 * accuracy) + (Math.random() - 0.5) * 50;
                const targetY = (deltaY * 2 * accuracy) - 400 + (Math.random() - 0.5) * 30;
                
                // Animate ball
                ball.style.transform = `translate(calc(-50% + ${targetX}px), ${targetY}px) scale(0.8)`;
                ball.style.transition = 'all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
                
                // Check if goal after animation
                setTimeout(() => {
                    const isGoal = this.checkGoal(targetX, targetY, goalkeepMove);
                    this.resolveShot(isGoal);
                    
                    setTimeout(() => {
                        this.resetBall();
                        goalkeeper.className = 'goalkeeper';
                        this.shooting = false;
                    }, 2000);
                }, 1000);
            }
            
            calculateAccuracy(deltaX, deltaY, power) {
                // Better accuracy with moderate power
                const powerPenalty = Math.abs(power - 0.7) * 0.3;
                return Math.max(0.3, 0.8 - powerPenalty);
            }
            
            checkGoal(targetX, targetY, goalkeepMove) {
                // Check if ball is within goal bounds
                const goalWidth = 150; // Half width from center
                const goalHeight = -350; // Approximate goal top
                
                if (Math.abs(targetX) > goalWidth || targetY > -200) {
                    return false; // Missed goal completely
                }
                
                // Check if goalkeeper saves it
                let saveChance = 0.3 + (this.level * 0.05); // Increases with level
                
                // Goalkeeper positioning affects save chance
                if (goalkeepMove === 'left' && targetX < -50) {
                    saveChance += 0.3;
                } else if (goalkeepMove === 'right' && targetX > 50) {
                    saveChance += 0.3;
                } else if (goalkeepMove === 'stay' && Math.abs(targetX) < 50) {
                    saveChance += 0.2;
                }
                
                return Math.random() > Math.min(saveChance, 0.8);
            }
            
            getGoalkeeperMove() {
                const moves = ['left', 'right', 'stay'];
                const weights = [0.35, 0.35, 0.3]; // Slightly favor diving
                const random = Math.random();
                
                if (random < weights[0]) return 'left';
                if (random < weights[0] + weights[1]) return 'right';
                return 'stay';
            }
            
            resolveShot(isGoal) {
                if (isGoal) {
                    this.score += 10;
                    this.goalsInLevel++;
                    this.showFeedback('GOAL! ⚽', 'goal');
                    
                    if (this.goalsInLevel >= this.goalsPerLevel) {
                        setTimeout(() => this.levelUp(), 1000);
                    }
                } else {
                    this.showFeedback('SAVED! 🥅', 'miss');
                }
                
                this.updateUI();
            }
            
            levelUp() {
                this.level++;
                this.goalsInLevel = 0;
                this.score += this.level * 20; // Bonus points
                this.showFeedback(`LEVEL ${this.level}! 🌟`, 'goal');
                
                if (this.level > 10) {
                    setTimeout(() => this.endGame(true), 2000);
                }
            }
            
            showFeedback(text, type) {
                const feedback = this.elements.feedback;
                feedback.textContent = text;
                feedback.className = `feedback ${type} show`;
                
                setTimeout(() => {
                    feedback.classList.remove('show');
                }, 2500);
            }
            
            resetBall() {
                const ball = this.elements.ball;
                ball.style.transform = 'translateX(-50%) scale(1)';
                ball.style.transition = 'all 0.3s ease';
            }
            
            updateUI() {
                this.elements.score.textContent = this.score;
                this.elements.level.textContent = this.level;
                this.elements.goals.textContent = this.goalsInLevel;
            }
            
            endGame(won = false) {
                this.gameActive = false;
                this.elements.finalScore.textContent = `Final Score: ${this.score}`;
                
                if (won) {
                    this.elements.gameOverMessage.textContent = '🏆 CHAMPION! You completed all levels!';
                } else {
                    this.elements.gameOverMessage.textContent = `🌟 Great job! You reached level ${this.level}!`;
                }
                
                this.elements.gameOver.style.display = 'flex';
            }
        }
        
        // Start the game
        new SoccerGame();
    </script>
</body>
</html>